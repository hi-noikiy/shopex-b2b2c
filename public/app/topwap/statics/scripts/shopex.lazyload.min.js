!function(t,e,n){var o=0;t.Lazyload=t.Class.extend({init:function(e,n){this.container=this.element=e,this.options=t.extend({selector:"",diff:!1,force:!1,autoDestroy:!0,duration:100},n),this._key=0,this._containerIsNotDocument=9!==this.container.nodeType,this._callbacks={},this._init()},_init:function(){this._initLoadFn(),this.addElements(),this._loadFn(),t.ready(function(){this._loadFn()}.bind(this)),this.resume()},_initLoadFn:function(){var e=this;e._loadFn=this._buffer(function(){e.options.autoDestroy&&0==e._counter&&t.isEmptyObject(e._callbacks)&&e.destroy(),e._loadItems()},e.options.duration,e)},_createLoader:function(t){var e,n,o,i=[];return function(s){return n||(n=!0,t(function(t){for(e=t;o=i.shift();)try{o&&o.apply(null,[e])}catch(n){setTimeout(function(){throw n},0)}})),e?(s&&s.apply(null,[e]),e):(s&&i.push(s),e)}},_buffer:function(e,n,o){function i(){s&&(s.cancel(),s=0),r=t.now(),e.apply(o||this,arguments),a=t.now()}var s,r=0,a=0,n=n||150;return t.extend(function(){!r||a>=r&&t.now()-a>n||a<r&&t.now()-r>8*n?i():(s&&s.cancel(),s=t.later(i,n,null,arguments))},{stop:function(){s&&(s.cancel(),s=0)}})},_getBoundingRect:function(n){var o,i,s,r;if(void 0!==n){o=n.offsetHeight,i=n.offsetWidth;var a=t.offset(n);s=a.left,r=a.top}else o=e.innerHeight,i=e.innerWidth,s=0,r=e.pageYOffset;var c=this.options.diff,h=c===!1?i:c,l=0,d=h,f=c===!1?o:c,_=0,u=f,m=s+i,p=r+o;return s-=l,m+=d,r-=_,p+=u,{left:s,top:r,right:m,bottom:p}},_cacheWidth:function(t){return t._shopex_lazy_width?t._shopex_lazy_width:t._shopex_lazy_width=t.offsetWidth},_cacheHeight:function(t){return t._shopex_lazy_height?t._shopex_lazy_height:t._shopex_lazy_height=t.offsetHeight},_isCross:function(t,e){var n={};return n.top=Math.max(t.top,e.top),n.bottom=Math.min(t.bottom,e.bottom),n.left=Math.max(t.left,e.left),n.right=Math.min(t.right,e.right),n.bottom>=n.top&&n.right>=n.left},_elementInViewport:function(e,n,o){if(!e.offsetWidth)return!1;var i,s=t.offset(e),r=!0,a=s.left,c=s.top,h={left:a,top:c,right:a+this._cacheWidth(e),bottom:c+this._cacheHeight(e)};return i=this._isCross(n,h),i&&o&&(r=this._isCross(o,h)),r&&i},_loadItems:function(){var e=this;e._containerIsNotDocument&&!e.container.offsetWidth||(e._windowRegion=e._getBoundingRect(),e._containerIsNotDocument&&(e._containerRegion=e._getBoundingRect(this.container)),t.each(e._callbacks,function(t,n){n&&e._loadItem(t,n)}))},_loadItem:function(t,e){var n=this;if(e=e||n._callbacks[t],!e)return!0;var o=e.el,i=!1,s=e.fn;if(n.options.force||n._elementInViewport(o,n._windowRegion,n._containerRegion))try{i=s.call(n,o,t)}catch(r){setTimeout(function(){throw r},0)}return i!==!1&&delete n._callbacks[t],i},addCallback:function(e,n){var o=this,i=o._callbacks,s={el:e,fn:n||t.noop},r=++this._key;i[r]=s,o._windowRegion?o._loadItem(r,s):o.refresh()},addElements:function(e){var n=this;n._counter=n._counter||0;var i=[];!e&&n.options.selector?i=n.container.querySelectorAll(n.options.selector):t.each(e,function(e,o){i=i.concat(t.qsa(n.options.selector,o))}),t.each(i,function(t,e){e.getAttribute("data-lazyload-id")||n.addElement(e)&&(e.setAttribute("data-lazyload-id",o++),n.addCallback(e,n.handle))})},addElement:function(t){return!0},handle:function(){},refresh:function(t){t&&this.addElements(),this._loadFn()},pause:function(){var n=this._loadFn;this._destroyed||(e.removeEventListener("scroll",n),e.removeEventListener(t.EVENT_MOVE,n),e.removeEventListener("resize",n),this._containerIsNotDocument&&(this.container.removeEventListener("scrollend",n),this.container.removeEventListener("scroll",n),this.container.removeEventListener(t.EVENT_MOVE,n)))},resume:function(){var n=this._loadFn;this._destroyed||(e.addEventListener("scroll",n,!1),e.addEventListener(t.EVENT_MOVE,n,!1),e.addEventListener("resize",n,!1),this._containerIsNotDocument&&(this.container.addEventListener("scrollend",n,!1),this.container.addEventListener("scroll",n,!1),this.container.addEventListener(t.EVENT_MOVE,n,!1)))},destroy:function(){var e=this;e.pause(),e._callbacks={},t.trigger(this.container,"destroy",e),e._destroyed=1}})}(shopex,window,document);