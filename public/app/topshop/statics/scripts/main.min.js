var dragDom=function(a){function b(a){this.style.opacity="1";dragSrcEl=this;a.dataTransfer.effectAllowed="move";a.dataTransfer.setData("innerhtml",this.innerHTML)}function c(a){this.classList.add("over")}function e(a){this.classList.remove("over")}function g(a){a.preventDefault&&a.preventDefault();return!1}function d(a){dragSrcEl!=this&&(dragSrcEl.innerHTML=this.innerHTML,this.innerHTML=a.dataTransfer.getData("innerhtml"));return!1}function f(a){this.style.opacity="1";[].forEach.call(divs,function(a){a.classList.remove("over")})}
a=document.querySelectorAll(a);[].forEach.call(a,function(a){a.addEventListener("dragstart",b,!1);a.addEventListener("dragenter",c,!1);a.addEventListener("dragover",g,!1);a.addEventListener("dragleave",e,!1);a.addEventListener("drop",d,!1);a.addEventListener("dragend",f,!1)})};function isBody(a){return/^(?:body|html)$/i.test(a.tagName)}function getCompatElement(){var a=document;return a.compatMode&&"CSS1Compat"!=a.compatMode?a.body:a.html}document.head=document.head||document.getElementsByTagName("head")[0];function isElement(a){a=a[0]||a;return a.nodeName&&1===a.nodeType}function substitute(a,b){return String(a).replace(/\\?\{([^{}]+)\}/g,function(a,e){return"\\"===a.charAt(0)?a.slice(1):null!=b[e]?b[e]:""})}
function checkAll(a,b){$(b).prop("checked",$(a).prop("checked"))}$.fn.outerHtml=function(){if("outerHTML"in document.body){var a="";this.each(function(b){a+=this.outerHTML});return a}return $("<div>").append(this.clone(!0,!0)).html()};
$.fn.patch=function(a){var b=this,c;c=a?$.makeArray(a):["margin","padding","border"];var e={x:0,y:0};$.each({x:["left","right"],y:["top","bottom"]},function(a,d){$.each(d,function(d,h){try{$.each(c,function(c,d){d+="-"+h;0==d.indexOf("border")&&(d+="-width");e[a]+=parseInt(b.css(d))||0})}catch(l){}})});return e};
$.fn.locate=function(a){a=$.extend({relative:document.body,x:"center",y:"center"},a);var b=$(a.relative),c,e=$(this).css("position","absolute"),g=e.height();c=e.width();var d=(b.is("body")?$(window):b).innerHeight(),f=b.innerWidth();switch(a.x){case 0:case "left":c=0;break;case "right":c=f-c;break;default:c=parseInt((f-c)/2)}switch(a.y){case 0:case "top":a=0;break;case "bottom":a=d-g;break;default:a=parseInt((d-g)/2)}e.css({left:Math.max(0,Math.floor(c+(b.offset()?b.offset().left:0)+b.scrollLeft())),
top:Math.max(0,Math.floor(a+(b.offset()?b.offset().top:0)+b.scrollTop()))});return this};
var Class=function(a){var b=function(){"function"===typeof this.init&&this.init.apply(this,arguments)};b.prototype=a||{};b.prototype.setOptions=function(){this.options=$.extend.apply(null,[!0,{},this.options].concat($.makeArray(arguments)));return this};b.prototype.trigger=function(a,b){a=this.options[a]||this.options["on"+a.replace(/^[a-z]/g,function(a){return a.toUpperCase()})];"function"===typeof a&&a.apply(this,$.makeArray(b));return this};return b};
(function(){var a,b,c=window.console;window.log=a=function(){b.push(arguments);c?c.log[c.firebug?"apply":"call"](c,Array.prototype.slice.call(arguments)):alert(Array.prototype.slice.call(arguments).join("\n"))};a.history=b=[];Date.prototype.Format=function(a){var b={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+
"").substr(4-RegExp.$1.length)));for(var d in b)RegExp("("+d+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?b[d]:("00"+b[d]).substr((""+b[d]).length)));return a}})();var imageUpload=function(a){function b(){for(var a=$(".img-show a"),b=0;b<a.length;b++)for(var e=0;e<h.length;e++)0<=h[e].img_id.indexOf($(a[b]).attr("href"))&&$(a[b]).parent().parent().addClass("checked")}a=$.extend({url:"",target:document.body,fileName:"upload_files",inputName:"images[]",size:512E3,width:50,height:50,multiple:!0,isModal:!1,limit:0,handle:".action-upload",file_input:".action-file-input",insertWhere:null,callback:null},a||{});var c,e,g,d,f,h=[];$(a.target).on("click",a.handle,function(b){$(this).parent().find(a.file_input).click()}).on("change",
a.file_input,function(b){var e=$(this);b=e.parent();var d=b.find(a.handle),c=this.getAttribute("data-filename")||a.fileName,f=this.getAttribute("data-size"),f=Number(f)||a.size,s=b.find(this.getAttribute("data-insertwhere")||a.insertWhere||".image-box"),p=this.multiple,h=this.getAttribute("data-ismodal"),x=this.getAttribute("data-remote")||a.url,t=this.getAttribute("data-max")||a.limit,v=this.getAttribute("name")||a.inputName,w=this.getAttribute("data-callback")||e.data("callback")||a.callback,u=
new FormData,r=this.files;if(t&&b.find(".img-thumbnail:not(.action-upload)").length+(p&&r?r.length:1)>t)return alert("超出限制，最多上传"+t+"张。"),!1;if(!r||!Array.prototype.slice.call(r).every(function(a,b){if(a.size>f)return $("#messagebox").message('抱歉，上传图片 "'+a.name+'" 须小于'+f/1024+"kB!"),e.val(""),!1;p?u.append(c+"[]",a):u.append(c,a);return!0}))return!1;$.ajax({url:x,type:"POST",data:u,cache:!1,contentType:!1,processData:!1,success:function(a){try{a=JSON.parse(a)}catch(b){}if(a.success&&a.data){if(w)return w(a);
var f="";if(p)if(h){var l=d.parents(".modal");$("#areaselect_modal").modal("hide");l.find(".nav-tabs .active").attr("data-type");l.find(".has-searched")&&$(".has-searched").val();l.find(".gallery-condition .active").hasClass("time")?(l.find(".gallery-condition .active").attr("data-order"),l.find(".gallery-condition .active").attr("data-sort")):l.find(".gallery-condition .active").attr("data-order");$.each(a.data,function(a,b){b.url&&(f=0>=e.parents(".note-image-dialog").length?g&&"true"==g?f+('<div class="col-sm-3"><div class="thumbnail checked"><div class="img-show"><a href='+
b.url+'"><img src="'+b.t_url+'"></a></div><div class="caption" data-name="'+b.url+'" data-url="'+b.url+'"><p class="image-name">'+b.image_name+"</p></div></div></div>"):f+('<div class="col-sm-3"><div class="thumbnail"><div class="img-show"><a href='+b.url+'"><img src="'+b.t_url+'"></a></div><div class="caption" data-name="'+b.url+'" data-url="'+b.url+'"><p class="image-name">'+b.image_name+"</p></div></div></div>"):f+('<div class="col-sm-3"><div class="thumbnail"><div class="img-show"><a href='+b.url+
'"><img src="'+b.t_url+'"></a></div><div class="caption" data-name="'+b.url+'" data-url="'+b.url+'"><p class="image-name">'+b.image_name+"</p></div></div></div>"))});$(f).insertBefore($(".gallery > div:first-child"))}else s=d,$.each(a.data,function(a,b){b.url&&(f+='<div class="handle img-thumbnail"><i class="icon-close-b" onclick="$(this).parent().remove();"></i><img src="'+b.url+'"><input type="hidden" name="'+v+'" value="'+b.image_id+'"></div>')}),$(f).insertBefore(s);else a=a.data[c],a.url&&(f=
'<img src="'+a.url+'"><input type="hidden" name="'+v+'" value="'+a.image_id+'">'),$(s).html(f)}else a.message&&($("#messagebox").message(a.message),e.val(""))},error:function(){$("#messagebox").message("上传出错，请重试")}})});$("#gallery_modal").on("shown.bs.modal",function(a){h=[];c=$(a.relatedTarget);e=c.attr("data-limit");g=c.attr("data-isMultiple");d=c.attr("data-name");c.parents(".multiple-upload").find(".multiple-item");f=c.parent().find(".multiple-item");$(this).attr("data-ids",h);0<f.length&&(f.each(function(a,
b){var e={};e.img_id=$(b).find("input").val();e.img_src=$(b).find("img").attr("src");h.push(e)}),b())}).on("click",".gallery-modal-tabs li a",function(a){a.preventDefault();var e=$(this);$(this).parent().addClass("active").siblings(".active").removeClass("active");a=$(this).attr("href");$.post(a,function(a){e.parents(".nav-tabs-custom").find(".gallery-modal-content").empty().append(a);b()})}).on("click",".action-save",function(){if(g&&"true"==g){var a="",b=h;$("#gallery_modal").find(".thumbnail.checked").each(function(){var a=
!1,e={};e.img_id=$(this).find(".caption").attr("data-name");e.img_src=$(this).find(".caption").attr("data-url");for(var d=0;d<h.length;d++)0<=h[d].img_id.indexOf(e.img_id)&&(a=!0);a||b.push(e)});for(var f=0;f<b.length;f++)a+='<div class="multiple-item"><div class="multiple-del glyphicon glyphicon-remove-circle"></div><a class="select-image"><input type="hidden" name="'+d+'" value="'+b[f].img_id+'"><div class="img-put"><img src="'+b[f].img_src+'"><i class="glyphicon glyphicon-picture"></i></div></a></div>';
0==b.length?$("#messagebox").message("请选择图片!"):b.length>e?$("#messagebox").message("您选择得图片数量超出最大限制!"):(c.parents(".multiple-upload").find(".multiple-item").remove(),$("#gallery_modal").modal("hide"),c.before(a),dragDom(".multiple-item"))}else{var a=$("#gallery_modal").find(".checked"),k=a.find("img").attr("src"),f=a.find(".caption").attr("data-name"),k='<img src="'+k+'">';0<a.length?(c.find(".img-put").empty().append(k),c.find("input").val(f),$("#gallery_modal").modal("hide")):$("#messagebox").message("请选择图片!")}}).on("hide.bs.modal",
function(a){$(this).removeData("bs.modal")}).on("click",".thumbnail",function(a){a.preventDefault();a={};a.img_id=$(this).find(".caption").attr("data-name");a.img_src=$(this).find(".caption").attr("data-url");if(g&&"true"==g)if($(this).toggleClass("checked"),$(this).hasClass("checked"))h.push(a);else for(var b=0;b<h.length;b++)h[b].img_id==a.img_id&&h.splice(b,1);else $(this).addClass("checked").parent().siblings().find(".thumbnail").removeClass("checked")}).on("click",".pagination a",function(a){a.preventDefault();
if(!$(this).parent().hasClass("disabled")){var b=h;$("#gallery_modal").find(".thumbnail.checked").each(function(){var a=!1,e={};e.img_id=$(this).find(".caption").attr("data-name");e.img_src=$(this).find(".caption").attr("data-url");for(var d=0;d<b.length;d++)0<=b[d].img_id.indexOf(e.img_id)&&(a=!0);a||h.push(e)});$.post($(this).attr("href"),function(a){setTimeout(function(){var a=$(".img-show a");if(f)for(var b=0;b<a.length;b++)for(var e=0;e<h.length;e++)0<=h[e].img_id.indexOf($(a[b]).attr("href"))&&
$(a[b]).parent().parent().addClass("checked")},100)})}});$(".note-image-dialog").on("shown.bs.modal",function(a){$(this).find(".gallery .thumbnail").removeClass("checked");$(this).find(".note-image-url").val("")}).on("click",".action-save",function(){var a=$(".note-image-dialog").find(".checked");a.find("img").attr("src");0<a.length?$(".note-image-dialog").modal("hide"):$("#messagebox").message("请选择图片!")}).on("click",".thumbnail",function(){var a=[];$(this).toggleClass("checked");for(var b=$(this).parents(".modal").find(".checked"),
e=0;e<b.length;e++){var d=$(b[e]).find(".caption").attr("data-url");a.push(d)}$(this).parents(".modal-body").find(".note-image-url").val(a)});$(".multiple-upload").on("click",".multiple-del",function(){$(this).parents(".multiple-upload").find(".multiple-add").show();$(this).parent().remove()})};jQuery(function(){imageUpload()});if("undefined"===typeof jQuery)throw Error("AdminLTE requires jQuery");$.AdminLTE={};
$.AdminLTE.options={navbarMenuSlimscroll:!0,navbarMenuSlimscrollWidth:"3px",navbarMenuHeight:"200px",animationSpeed:500,sidebarToggleSelector:"[data-toggle='offcanvas']",sidebarPushMenu:!0,sidebarSlimScroll:!0,sidebarExpandOnHover:!1,enableBoxRefresh:!0,enableBSToppltip:!0,BSTooltipSelector:"[data-toggle='tooltip']",enableFastclick:!1,enableControlSidebar:!0,controlSidebarOptions:{toggleBtnSelector:"[data-toggle='control-sidebar']",selector:".control-sidebar",slide:!0},enableBoxWidget:!0,boxWidgetOptions:{boxWidgetIcons:{collapse:"fa-minus",
open:"fa-plus",remove:"fa-times"},boxWidgetSelectors:{remove:'[data-widget="remove"]',collapse:'[data-widget="collapse"]'}},directChat:{enable:!0,contactToggleSelector:'[data-widget="chat-pane-toggle"]'},colors:{lightBlue:"#3c8dbc",red:"#f56954",green:"#00a65a",aqua:"#00c0ef",yellow:"#f39c12",blue:"#0073b7",navy:"#001F3F",teal:"#39CCCC",olive:"#3D9970",lime:"#01FF70",orange:"#FF851B",fuchsia:"#F012BE",purple:"#8E24AA",maroon:"#D81B60",black:"#222222",gray:"#d2d6de"},screenSizes:{xs:480,sm:768,md:992,
lg:1200}};
$(function(){$("body").removeClass("hold-transition");"undefined"!==typeof AdminLTEOptions&&$.extend(!0,$.AdminLTE.options,AdminLTEOptions);var a=$.AdminLTE.options;_init();$.AdminLTE.layout.activate();$.AdminLTE.tree(".sidebar");a.enableControlSidebar&&$.AdminLTE.controlSidebar.activate();a.navbarMenuSlimscroll&&"undefined"!=typeof $.fn.slimscroll&&$(".navbar .menu").slimscroll({height:a.navbarMenuHeight,alwaysVisible:!1,size:a.navbarMenuSlimscrollWidth}).css("width","100%");a.sidebarPushMenu&&$.AdminLTE.pushMenu.activate(a.sidebarToggleSelector);
a.enableBSToppltip&&$("body").tooltip({selector:a.BSTooltipSelector});a.enableBoxWidget&&$.AdminLTE.boxWidget.activate();a.enableFastclick&&"undefined"!=typeof FastClick&&FastClick.attach(document.body);if(a.directChat.enable)$(document).on("click",a.directChat.contactToggleSelector,function(){$(this).parents(".direct-chat").first().toggleClass("direct-chat-contacts-open")});$('.btn-group[data-toggle="btn-toggle"]').each(function(){var a=$(this);$(this).find(".btn").on("click",function(c){a.find(".btn.active").removeClass("active");
$(this).addClass("active");c.preventDefault()})})});
function _init(){$.AdminLTE.layout={activate:function(){var a=this;a.fix();a.fixSidebar();$(window,".wrapper").resize(function(){a.fix();a.fixSidebar()})},fix:function(){var a=$(".main-header").outerHeight()+$(".main-footer").outerHeight(),b=$(window).height(),c=$(".sidebar").height();$("body").hasClass("fixed")?$(".content-wrapper, .right-side").css("min-height",b-$(".main-footer").outerHeight()):(b>=c?($(".content-wrapper, .right-side").css("min-height",b-a),a=b-a):($(".content-wrapper, .right-side").css("min-height",
c),a=c),b=$($.AdminLTE.options.controlSidebarOptions.selector),"undefined"!==typeof b&&b.height()>a&&$(".content-wrapper, .right-side").css("min-height",b.height()))},fixSidebar:function(){$("body").hasClass("fixed")?("undefined"==typeof $.fn.slimScroll&&window.console&&window.console.error("Error: the fixed layout requires the slimscroll plugin!"),$.AdminLTE.options.sidebarSlimScroll&&"undefined"!=typeof $.fn.slimScroll&&($(".sidebar").slimScroll({destroy:!0}).height("auto"),$(".sidebar").slimscroll({height:$(window).height()-
$(".main-header").height()+"px",color:"rgba(0,0,0,0.2)",size:"3px"}))):"undefined"!=typeof $.fn.slimScroll&&$(".sidebar").slimScroll({destroy:!0}).height("auto")}};$.AdminLTE.pushMenu={activate:function(a){var b=$.AdminLTE.options.screenSizes;$(document).on("click",a,function(a){a.preventDefault();$(window).width()>b.sm-1?$("body").hasClass("sidebar-collapse")?$("body").removeClass("sidebar-collapse").trigger("expanded.pushMenu"):$("body").addClass("sidebar-collapse").trigger("collapsed.pushMenu"):
$("body").hasClass("sidebar-open")?$("body").removeClass("sidebar-open").removeClass("sidebar-collapse").trigger("collapsed.pushMenu"):$("body").addClass("sidebar-open").trigger("expanded.pushMenu")});$(".content-wrapper").click(function(){$(window).width()<=b.sm-1&&$("body").hasClass("sidebar-open")&&$("body").removeClass("sidebar-open")});($.AdminLTE.options.sidebarExpandOnHover||$("body").hasClass("fixed")&&$("body").hasClass("sidebar-mini"))&&this.expandOnHover()},expandOnHover:function(){var a=
this,b=$.AdminLTE.options.screenSizes.sm-1;$(".main-sidebar").hover(function(){$("body").hasClass("sidebar-mini")&&$("body").hasClass("sidebar-collapse")&&$(window).width()>b&&a.expand()},function(){$("body").hasClass("sidebar-mini")&&$("body").hasClass("sidebar-expanded-on-hover")&&$(window).width()>b&&a.collapse()})},expand:function(){$("body").removeClass("sidebar-collapse").addClass("sidebar-expanded-on-hover")},collapse:function(){$("body").hasClass("sidebar-expanded-on-hover")&&$("body").removeClass("sidebar-expanded-on-hover").addClass("sidebar-collapse")}};
$.AdminLTE.tree=function(a){var b=this,c=$.AdminLTE.options.animationSpeed;$(document).off("click",a+" li a").on("click",a+" li a",function(a){var g=$(this),d=g.next();if(d.is(".treeview-menu")&&d.is(":visible")&&!$("body").hasClass("sidebar-collapse"))d.slideUp(c,function(){d.removeClass("menu-open")}),d.parent("li").removeClass("active");else if(d.is(".treeview-menu")&&!d.is(":visible")){var f=g.parents("ul").first();f.find("ul:visible").slideUp(c).removeClass("menu-open");var h=g.parent("li");
d.slideDown(c,function(){d.addClass("menu-open");f.find("li.active").removeClass("active");h.addClass("active");b.layout.fix()})}d.is(".treeview-menu")&&a.preventDefault()})};$.AdminLTE.controlSidebar={activate:function(){var a=this,b=$.AdminLTE.options.controlSidebarOptions,c=$(b.selector);$(b.toggleBtnSelector).on("click",function(e){e.preventDefault();c.hasClass("control-sidebar-open")||$("body").hasClass("control-sidebar-open")?a.close(c,b.slide):a.open(c,b.slide)});var e=$(".control-sidebar-bg");
a._fix(e);$("body").hasClass("fixed")?a._fixForFixed(c):$(".content-wrapper, .right-side").height()<c.height()&&a._fixForContent(c)},open:function(a,b){b?a.addClass("control-sidebar-open"):$("body").addClass("control-sidebar-open")},close:function(a,b){b?a.removeClass("control-sidebar-open"):$("body").removeClass("control-sidebar-open")},_fix:function(a){var b=this;$("body").hasClass("layout-boxed")?(a.css("position","absolute"),a.height($(".wrapper").height()),b.hasBindedResize||($(window).resize(function(){b._fix(a)}),
b.hasBindedResize=!0)):a.css({position:"fixed",height:"auto"})},_fixForFixed:function(a){a.css({position:"fixed","max-height":"100%",overflow:"auto","padding-bottom":"50px"})},_fixForContent:function(a){$(".content-wrapper, .right-side").css("min-height",a.height())}};$.AdminLTE.boxWidget={selectors:$.AdminLTE.options.boxWidgetOptions.boxWidgetSelectors,icons:$.AdminLTE.options.boxWidgetOptions.boxWidgetIcons,animationSpeed:$.AdminLTE.options.animationSpeed,activate:function(a){var b=this;a||(a=document);
$(a).on("click",b.selectors.collapse,function(a){a.preventDefault();b.collapse($(this))});$(a).on("click",b.selectors.remove,function(a){a.preventDefault();b.remove($(this))})},collapse:function(a){var b=a.parents(".box").first(),c=b.find("> .box-body, > .box-footer, > form  >.box-body, > form > .box-footer");b.hasClass("collapsed-box")?(a.children(":first").removeClass(this.icons.open).addClass(this.icons.collapse),c.slideDown(this.animationSpeed,function(){b.removeClass("collapsed-box")})):(a.children(":first").removeClass(this.icons.collapse).addClass(this.icons.open),
c.slideUp(this.animationSpeed,function(){b.addClass("collapsed-box")}))},remove:function(a){a.parents(".box").first().slideUp(this.animationSpeed)}}}
(function(a){a.fn.boxRefresh=function(b){function c(a){a.append(g);e.onLoadStart.call(a)}var e=a.extend({trigger:".refresh-btn",source:"",onLoadStart:function(a){return a},onLoadDone:function(a){return a}},b),g=a('<div class="overlay"><div class="fa fa-refresh fa-spin"></div></div>');return this.each(function(){if(""===e.source)window.console&&window.console.log("Please specify a source first - boxRefresh()");else{var b=a(this);b.find(e.trigger).first().on("click",function(a){a.preventDefault();c(b);
b.find(".box-body").load(e.source,function(){b.find(g).remove();e.onLoadDone.call(b)})})}})}})(jQuery);(function(a){a.fn.activateBox=function(){a.AdminLTE.boxWidget.activate(this)};a.fn.toggleBox=function(){var b=a(a.AdminLTE.boxWidget.selectors.collapse,this);a.AdminLTE.boxWidget.collapse(b)};a.fn.removeBox=function(){var b=a(a.AdminLTE.boxWidget.selectors.remove,this);a.AdminLTE.boxWidget.remove(b)}})(jQuery);
(function(a){a.fn.todolist=function(b){var c=a.extend({onCheck:function(a){return a},onUncheck:function(a){return a}},b);return this.each(function(){if("undefined"!=typeof a.fn.iCheck)a("input",this).on("ifChecked",function(){var b=a(this).parents("li").first();b.toggleClass("done");c.onCheck.call(b)}),a("input",this).on("ifUnchecked",function(){var b=a(this).parents("li").first();b.toggleClass("done");c.onUncheck.call(b)});else a("input",this).on("change",function(){var b=a(this).parents("li").first();
b.toggleClass("done");a("input",b).is(":checked")?c.onCheck.call(b):c.onUncheck.call(b)})})}})(jQuery);
(function(a){a.fn.message=function(b,c,e,g){var d=this;this.data("timer")&&(clearTimeout(this.data("timer")),this.timer=null);this[0].className=this[0].className.replace(/alert-(success|error|warning|info|danger)/g,"");this.html(b).addClass("alert-"+(c||"error"));b=a("header.main-header").size()?a("header.main-header").height():"top";this.fadeIn("fast").center({top:b});this.data("timer",setTimeout(function(){d.fadeOut("fast");g&&g()},e||3E3))}})(jQuery);
(function(a){jQuery.fn.center=function(b){b=a.extend(!0,{},b);parent=b.parent?this.parent().css("position","relative"):window;this.css({top:"top"===b.top?0:b.top?b.top:(a(parent).height()-this.outerHeight())/2+a(parent).scrollTop()+"px",left:"left"===b.left?0:b.left?b.left:(a(parent).width()-this.outerWidth())/2+a(parent).scrollLeft()+"px"});return this}})(jQuery);
$(function(){$(".btn").bind("touchstart",function(){$(this).addClass("hover")}).bind("touchend",function(){$(this).removeClass("hover")});$("form:not([novalidate])").Validator({icons:{valid:"icon icon-checkmark-a",invalid:"icon icon-alert",validating:"icon icon-loading-c"}});$("body").on("click",".show-pics a",function(a){a.preventDefault();if(a=$(this).attr("href"))$("#show_img_madal").modal("show"),$("#big_img").attr("src",a);else return!1});$(".switch-input").bootstrapSwitch({onText:"是",offText:"否",
size:"small"})});
(function(a){if(!window.localStorage||!window.JSON)return a.fn.rememberState=function(){return this};var b={name:"rememberState",clearOnSubmit:!0,ignore:null,use_ids:!1,mark:null,restoreState:function(a){var b=JSON.parse(localStorage.getItem(this.mark)),d=this.$el,f,c;for(c in b)f=d.find('[name="'+b[c].name+'"]'),f.is(":radio")?f.filter('[value="'+b[c].value+'"]').prop("checked",!0):f.is(":checkbox")&&b[c].value?f.prop("checked",!0):f.is("select")?f.find('[value="'+b[c].value+'"]').prop("selected",!0):
f.val(b[c].value),f.change();a&&a.preventDefault&&a.preventDefault()},saveState:function(b){b=b.data.instance;var g=b.$el.serializeArray();b.$el.find("input[type='datetime-local']").each(function(){var b=a(this);g.push({name:b.attr("name"),value:b.val()})});g=b.removeIgnored(g);g.length&&c.setObject(b.mark,g)},save:function(){var a=this;this.saveState||(a=this.data(b.name));a.saveState({data:{instance:a}})},removeIgnored:function(b){var c=this.ignore;if(!c)return b;a.each(b,function(d,f){-1!==a.inArray(f.name,
c)&&(b[d]=!1)});return b=a.grep(b,function(a){return a})},setName:function(){(this.mark=this.mark||this.$el.attr("id"))||console.warn("No form ID or other mark.");this.mark="rememberstate_"+this.mark},bindResetEvents:function(){var b=this;this.clearOnSubmit&&this.$el.bind("submit."+this.name,function(){a(this).trigger("reset_state");a(window).unbind("unload."+b.name)});this.$el.bind("reset_state."+this.name,function(){localStorage.removeItem(b.mark)});this.$el.find(":reset").bind("click."+this.name,
function(){a(this).closest("form").trigger("reset_state")})},destroy:function(b){var c="."+this.name;this.$el.unbind(c).find(":reset").unbind(c);a(window).unbind(c);b&&localStorage.removeItem(this.mark)},init:function(){this.setName();this.mark&&(this.bindResetEvents(),a(window).bind("unload."+this.name,{instance:this},this.saveState))}},c={setObject:function(a,b){localStorage[a]=JSON.stringify(b)},getObject:function(a){return JSON.parse(localStorage[a])},createPlugin:function(b){a.fn[b.name]=function(c){var d=
this,f=a.isPlainObject(c)||!c?"":c,h=arguments;f&&b[f]?d.each(function(a){b[f].apply(d.eq(a).data(b.name),Array.prototype.slice.call(h,1))}):f?a.error("Method "+f+" does not exist on jQuery."+b.name):d.each(function(f){var h=a.extend(!0,{$el:d.eq(f)},b,c);d.eq(f).data(b.name,h);h.init()});return d}}};c.createPlugin(b)})(jQuery);var goodsChoose=function(a){a=$.extend({url:"",getProUrl:"",getBrandUrl:"",getGoodsUrl:"",target:document.body,modalDom:"#goods_modal",handle:".select-goods",catBox:".goods-category",catlistItem:".goods-category li",catDefault:"分类",brandBox:".goods-brands",brandList:"#brand_list",brandListItem:"#brand_list li",brandDefault:"品牌",filterBtn:"#search_goods",skuFilterBtn:"#sku_search_goods",clearFilterBtn:"#clear_filter",clearBrandBtn:"#clear_brand",submitBtn:"#choose_goods",skuSubmitBtn:"#sku_choose_goods",
checkAll:"#check_all",uncheckAll:"#uncheck_all",goodsList:"#goods_list",skuList:"#sku_list",goodsListItem:"#goods_list > ul > li",skuListItem:"#sku_list > ul > li",goodsSearchKey:".goods-search-key",goodsSearchBn:".goods-search-bn",goodsSearchBrand:".goods-search-brand",insertWhere:null,textcol:null,view:null,getPro:function(a,b,c,d,e,g,h,l){$.ajax({url:b,type:"POST",dataType:"html",data:{searchname:e,searchbn:g,searchbrand:h,catId:c,brandId:d},success:function(b){$(a).html(b);b=$(a).find("li");for(var c=
0;c<b.length;c++)for(var d=$(b[c]).attr("data-id"),e=0;e<f.length;e++)d==f[e]&&$(b[c]).addClass("checked");if(l)return l()}})}},a||{});var b,c,e,g,d,f=[],h=$(a.handle).attr("data-remote")||a.url,l=$(a.handle).attr("data-item_id"),q=$(a.handle).attr("data-fetchgoods")||a.getGoodsUrl,n=$(a.insertWhere||".selected-goods-list");limit=$(a.handle).data("limit")||a.limit;$(a.target).on("click",a.handle,function(b){b.preventDefault();b=$(this).parents(".select-goods-panel");n=$(b).find(this.getAttribute("data-insertwhere")||
a.insertWhere||".selected-goods-list");$(this).attr("data-modal")?$($(this).attr("data-modal")).modal("show"):$(a.modalDom).modal("show")});$(a.handle).each(function(){var k=$(this);d=$(this).data();for(var m in d)"remote"===m&&delete d[m],"fetchgoods"===m&&delete d[m],"target"===m&&delete d[m],"limit"===m&&delete d[m];l=$(this).attr("data-item_id");q=$(this).attr("data-fetchgoods")||a.getGoodsUrl;l&&0<l.length&&$.post(q,d,function(b){b&&(n=k.parents(".select-goods-panel").find(a.insertWhere||".selected-goods-list"),
$(n).html(b))});$($(this).attr("data-modal")||a.modalDom).on("show.bs.modal",function(){n=k.parents(".select-goods-panel").find(a.insertWhere||".selected-goods-list");limit=k.data("limit")||a.limit;f=[];var b=$(n).find("tr");k.attr("data-modal")&&"#sku_modal"==k.attr("data-modal")&&(b=$(n).find(".sku-item"));$(b).each(function(a,b){f.push($(b).attr("date-itemid"))});h=k.attr("data-remote")||a.url;$(this).find(".modal-content").load(h)}).on("shown.bs.modal",function(){l=k.attr("data-item_id");q=k.attr("data-fetchgoods")||
a.getGoodsUrl;k.attr("data-modal")&&"#sku_modal"==k.attr("data-modal")?(g=a.skuList,b=$(a.skuFilterBtn).attr("data-remote")||a.getProUrl):(g=a.goodsList,b=$(a.filterBtn).attr("data-remote")||a.getProUrl);a.getPro(g,b,"","","","","",function(){for(var a=$(g).find("li"),b=0;b<a.length;b++)for(var c=$(a[b]).attr("data-id"),d=0;d<f.length;d++)c==f[d]&&$(a[b]).addClass("checked")})}).on("hide.bs.modal",function(){a.getPro(g,b)}).on("click",a.catlistItem,function(a){a.stopPropagation();$(this).attr("data-val")&&
(c=$(this).attr("data-val"),a=$(this).children("span").text(),$(this).parents(".filters-list").hide().siblings(".filter-name").text(a))}).on("click",a.brandListItem,function(){e=$(this).attr("data-val");var a=$(this).text();$(this).parents(".filters-list").hide().siblings(".filter-name").text(a)}).on("click",a.filterBtn+","+a.skuFilterBtn,function(){var d=$(this).parent().find('input[name="item_title"]').val(),p=$(this).parent().find('input[name="item_bn"]').val(),h=$(this).parent().find('input[name="item_brand"]').val();
a.getPro(g,b,c,e,d,p,h,function(){for(var a=$(g).find("li"),b=0;b<a.length;b++)for(var c=$(a[b]).attr("data-id"),d=0;d<f.length;d++)c==f[d]&&$(a[b]).addClass("checked")})}).on("click",a.goodsListItem+","+a.skuListItem,function(){$(this).toggleClass("checked");var a=$(this).data("id");if($(this).hasClass("checked")){if(limit){if("number"===typeof limit&&0<parseInt(limit))limit=parseInt(limit);else return;if($(this).parent().parent().find(".checked").length>limit){$("#messagebox").message("最多只能选择"+
limit+"个商品");$(this).removeClass("checked");return}}f.push(a)}else for(var b=0;b<f.length;b++)f[b]==a&&f.splice(b,1)}).on("click",a.checkAll,function(){var b=k.attr("data-modal")&&"#sku_modal"==k.attr("data-modal")?$(a.skuListItem):$(a.goodsListItem),c=[];b.addClass("checked");for(var d=0;d<b.length;d++){var e=$(b[d]).data("id");c.push(e)}f=$.unique($.merge(f,c))}).on("click",a.uncheckAll,function(){var b=k.attr("data-modal")&&"#sku_modal"==k.attr("data-modal")?$(a.skuListItem):$(a.goodsListItem),
c=[];b.removeClass("checked");for(var d=f.concat(),e=0;e<b.length;e++){var g=$(b[e]).data("id");c.push(g)}for(e=0;e<d.length;e++)for(b=0;b<c.length;b++)if(d[e]==c[b]){f.splice(0,1);break}}).on("mouseover mouseout",a.catBox,function(a){var b=$(this).children(".filters-list");"mouseover"==a.type?b.show():"mouseout"==a.type&&b.hide()}).on("mouseover mouseout",a.brandBox,function(a){var b=$(this).children(".filters-list");"mouseover"==a.type?b.show():"mouseout"==a.type&&b.hide()}).on("mouseover mouseout",
a.catlistItem,function(a){var b=$(this).children(".child-list");$(b)&&("mouseover"==a.type?b.show():"mouseout"==a.type&&b.hide())}).on("click",a.clearFilterBtn,function(d){d.preventDefault();e=c=null;$(a.catBox).find(".filter-name").text(a.catDefault);$(a.brandBox).find(".filter-name").text(a.brandDefault);$(a.brandList).empty();$(a.goodsSearchKey).val("");$(a.goodsSearchBn).val("");$(a.goodsSearchBrand).val("");b=$(a.filterBtn).attr("data-remote")||a.getProUrl;k.attr("data-modal")&&"#sku_modal"==
k.attr("data-modal")&&(b=$(a.skuFilterBtn).attr("data-remote")||a.getProUrl);a.getPro(g,b,"","","","",function(){})}).on("click",a.clearBrandBtn,function(b){b.preventDefault();e=null;$(a.brandBox).find(".filter-name").text(a.brandDefault)}).on("click",a.submitBtn+","+a.skuSubmitBtn,function(){if(0==f.length)$("#messagebox").message("请选择商品");else if(k.attr("data-modal")&&"#sku_modal"==k.attr("data-modal")&&4<f.length)$("#messagebox").message("最多只能添加4件赠品");else{var b={item_id:f};d=k.data();d=$.extend(d,
b);$.post(q,d,function(b){b?($(n).html(b),$(k.attr("data-modal")||a.modalDom).modal("hide")):$("#messagebox").message("还未添加商品")})}}).on("click",".pagination a",function(a){a.preventDefault();$(this).parent().hasClass("disabled")||$.post($(this).attr("href"),function(a){$(g).html(a);a=$(g).find("li");for(var b=0;b<a.length;b++)for(var c=$(a[b]).attr("data-id"),d=0;d<f.length;d++)c==f[d]&&$(a[b]).addClass("checked")})})})};$(function(){goodsChoose()});